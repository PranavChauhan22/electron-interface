(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,t,s){"use strict";s.r(t);var n=s(0),c=(s(67),s(68),s(69),s(70),s(1)),a=s(22),r=s.n(a),o=s(2),i=s(3),l=s(4),d=s.n(l),u=s(6),j=s(134),m=function(e){var t=e.width,s=void 0===t?64:t,c=e.height,a=void 0===c?64:c;return Object(n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32",height:a,width:s,children:[Object(n.jsx)("script",{}),Object(n.jsxs)("defs",{children:[Object(n.jsx)("path",{id:"prefix__a",d:"M45.536 38.764c-2.013 1.05-12.44 5.337-14.66 6.494s-3.453 1.146-5.207.308-12.85-5.32-14.85-6.276c-1-.478-1.524-.88-1.524-1.26v-3.813s14.447-3.145 16.78-3.982 3.14-.867 5.126-.14 13.853 2.868 15.814 3.587v3.76c0 .377-.452.8-1.477 1.324z"}),Object(n.jsx)("path",{id:"prefix__b",d:"M45.536 28.733c-2.013 1.05-12.44 5.337-14.66 6.494s-3.453 1.146-5.207.308-12.85-5.32-14.85-6.276-2.04-1.613-.077-2.382l15.332-5.935c2.332-.837 3.14-.867 5.126-.14s12.35 4.853 14.312 5.57 2.037 1.31.024 2.36z"})]}),Object(n.jsxs)("g",{transform:"matrix(.84833 0 0 .84833 -7.884 -9.45)",children:[Object(n.jsx)("use",{fill:"#a41e11",xlinkHref:"#prefix__a"}),Object(n.jsx)("path",{d:"M45.536 34.95c-2.013 1.05-12.44 5.337-14.66 6.494s-3.453 1.146-5.207.308-12.85-5.32-14.85-6.276-2.04-1.613-.077-2.382l15.332-5.936c2.332-.836 3.14-.867 5.126-.14S43.55 31.87 45.51 32.6s2.037 1.31.024 2.36z",fill:"#d82c20"}),Object(n.jsx)("use",{fill:"#a41e11",xlinkHref:"#prefix__a",y:-6.218}),Object(n.jsx)("use",{fill:"#d82c20",xlinkHref:"#prefix__b"}),Object(n.jsx)("path",{d:"M45.536 26.098c-2.013 1.05-12.44 5.337-14.66 6.495s-3.453 1.146-5.207.308-12.85-5.32-14.85-6.276c-1-.478-1.524-.88-1.524-1.26V21.55s14.447-3.145 16.78-3.982 3.14-.867 5.126-.14 13.853 2.868 15.814 3.587v3.76c0 .377-.452.8-1.477 1.324z",fill:"#a41e11"}),Object(n.jsx)("use",{fill:"#d82c20",xlinkHref:"#prefix__b",y:-6.449}),Object(n.jsxs)("g",{fill:"#fff",children:[Object(n.jsx)("path",{d:"M29.096 20.712l-1.182-1.965-3.774-.34 2.816-1.016-.845-1.56 2.636 1.03 2.486-.814-.672 1.612 2.534.95-3.268.34zM22.8 24.624l8.74-1.342-2.64 3.872z"}),Object(n.jsx)("ellipse",{cx:20.444,cy:21.402,rx:4.672,ry:1.811})]}),Object(n.jsx)("path",{d:"M42.132 21.138l-5.17 2.042-.004-4.087z",fill:"#7a0c00"}),Object(n.jsx)("path",{d:"M36.963 23.18l-.56.22-5.166-2.042 5.723-2.264z",fill:"#ad2115"})]})]})};s(75);function b(e){var t=e.onLogIn,s=Object(c.useState)([""]),a=Object(i.a)(s,2),r=a[0],o=a[1];console.log(r);var l=Object(c.useState)((function(){return r[Math.floor(Math.random()*r.length)]})),b=Object(i.a)(l,2),O=b[0],h=b[1],p=Object(c.useState)("password123"),x=Object(i.a)(p,2),g=x[0],v=x[1],y=Object(c.useState)(null),N=Object(i.a)(y,2),w=N[0],k=N[1],M=function(){var e=Object(u.a)(d.a.mark((function e(s){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.preventDefault(),console.log(O),t(O,g,k);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)(Object(u.a)(d.a.mark((function e(){var t,s,n,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://redis-node-server.adaptable.app/members",{method:"GET"});case 2:return t=e.sent,e.next=5,t.json();case 5:for(s=e.sent,n=[],c=0;c<s.length;c++)a=s[c],n.push(a.displayName);n.sort(),o(n);case 10:case"end":return e.stop()}}),e)}))),[]),Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("div",{className:"login-form text-center login-page",children:Object(n.jsxs)("div",{className:"rounded",style:{boxShadow:"0 0.75rem 1.5rem rgba(18,38,63,.03)"},children:[Object(n.jsxs)("div",{className:"position-relative",children:[Object(n.jsxs)("div",{className:"row no-gutters align-items-center",style:{maxWidth:400,backgroundColor:"rgba(85, 110, 230, 0.25)",paddingLeft:20,paddingRight:20,borderTopLeftRadius:4,borderTopRightRadius:4},children:[Object(n.jsxs)("div",{className:"col text-primary text-left",children:[Object(n.jsx)("h3",{className:"font-size-15",children:"Welcome Back !"}),Object(n.jsx)("p",{children:"Sign in to continue"})]}),Object(n.jsx)("div",{className:"col align-self-end",children:Object(n.jsx)("img",{alt:"welcome back",style:{maxWidth:"100%"},src:"".concat("","/welcome-back.png")})})]}),Object(n.jsx)("div",{className:"position-absolute",style:{bottom:-36,left:20},children:Object(n.jsx)("div",{style:{backgroundColor:"rgb(239, 242, 247)",width:72,height:72},className:"rounded-circle d-flex align-items-center justify-content-center",children:Object(n.jsx)(m,{width:34,height:34})})})]}),Object(n.jsxs)("form",{className:"bg-white text-left px-4",style:{paddingTop:58,borderBottomLeftRadius:4,borderBottomRightRadius:4},onSubmit:M,children:[Object(n.jsx)("label",{className:"font-size-12",children:"Name"}),Object(n.jsx)("div",{className:"username-select mb-3",children:Object(n.jsx)(f,{username:O,setUsername:h,names:r})}),Object(n.jsx)("label",{htmlFor:"inputPassword",className:"font-size-12",children:"Password"}),Object(n.jsx)("input",{value:g,onChange:function(e){return v(e.target.value)},type:"password",id:"inputPassword",className:"form-control",placeholder:"Password",required:!0}),Object(n.jsx)("div",{style:{height:30}}),Object(n.jsx)("button",{className:"btn btn-lg btn-primary btn-block",type:"submit",children:"Sign in"}),Object(n.jsx)("div",{className:"login-error-anchor",children:Object(n.jsx)("div",{className:"toast-box",children:Object(n.jsxs)(j.a,{style:{minWidth:277},onClose:function(){return k(null)},show:null!==w,delay:3e3,autohide:!0,children:[Object(n.jsxs)(j.a.Header,{children:[Object(n.jsx)("img",{src:"holder.js/20x20?text=%20",className:"rounded mr-2",alt:""}),Object(n.jsx)("strong",{className:"mr-auto",children:"Error"})]}),Object(n.jsx)(j.a.Body,{children:w})]})})}),Object(n.jsx)("div",{style:{height:30}})]})]})})})}var f=function(e){var t,s=e.username,a=e.setUsername,r=e.names,o=void 0===r?[""]:r,l=Object(c.useState)(!1),d=Object(i.a)(l,2),u=d[0],j=d[1],m=Object(c.useState)(0),b=Object(i.a)(m,2),f=b[0],O=b[1],h=Object(c.useRef)(),p=null===(t=h.current)||void 0===t?void 0:t.getBoundingClientRect().width;return Object(c.useEffect)((function(){O(p)}),[p]),Object(c.useEffect)((function(){if(u){var e=function(){return j(!1)};return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}}}),[u]),Object(c.useEffect)((function(){var e;u&&(null===(e=h.current)||void 0===e||e.focus())}),[u]),Object(n.jsxs)("div",{tabIndex:0,ref:h,className:"username-select-dropdown ".concat(u?"open":""),onClick:function(){return j((function(e){return!e}))},children:[Object(n.jsxs)("div",{className:"username-select-row",children:[Object(n.jsx)("div",{children:s}),Object(n.jsx)("div",{children:Object(n.jsx)("svg",{width:24,height:24,children:Object(n.jsx)("path",{d:"M7 10l5 5 5-5z",fill:"#333"})})})]}),Object(n.jsx)("div",{style:{width:f},className:"username-select-block ".concat(u?"open":""),children:o.map((function(e){return Object(n.jsx)("div",{className:"username-select-block-item",onClick:function(){return a(e)},children:e},e)}))})]})},O=s(18),h=(s(78),s(12)),p=function(e,t){switch(t.type){case"clear":return{currentRoom:"0",rooms:{},users:{}};case"set user":return Object(o.a)(Object(o.a)({},e),{},{users:Object(o.a)(Object(o.a)({},e.users),{},Object(h.a)({},t.payload.id,t.payload))});case"make user online":return Object(o.a)(Object(o.a)({},e),{},{users:Object(o.a)(Object(o.a)({},e.users),{},Object(h.a)({},t.payload,Object(o.a)(Object(o.a)({},e.users[t.payload]),{},{online:!0})))});case"append users":return Object(o.a)(Object(o.a)({},e),{},{users:Object(o.a)(Object(o.a)({},e.users),t.payload)});case"set messages":return Object(o.a)(Object(o.a)({},e),{},{rooms:Object(o.a)(Object(o.a)({},e.rooms),{},Object(h.a)({},t.payload.id,Object(o.a)(Object(o.a)({},e.rooms[t.payload.id]),{},{messages:t.payload.messages,offset:t.payload.messages.length})))});case"prepend messages":var s=[].concat(Object(O.a)(t.payload.messages),Object(O.a)(e.rooms[t.payload.id].messages));return Object(o.a)(Object(o.a)({},e),{},{rooms:Object(o.a)(Object(o.a)({},e.rooms),{},Object(h.a)({},t.payload.id,Object(o.a)(Object(o.a)({},e.rooms[t.payload.id]),{},{messages:s,offset:s.length})))});case"append message":return void 0===e.rooms[t.payload.id]?e:Object(o.a)(Object(o.a)({},e),{},{rooms:Object(o.a)(Object(o.a)({},e.rooms),{},Object(h.a)({},t.payload.id,Object(o.a)(Object(o.a)({},e.rooms[t.payload.id]),{},{lastMessage:t.payload.message,messages:e.rooms[t.payload.id].messages?[].concat(Object(O.a)(e.rooms[t.payload.id].messages),[t.payload.message]):void 0})))});case"set last message":return Object(o.a)(Object(o.a)({},e),{},{rooms:Object(o.a)(Object(o.a)({},e.rooms),{},Object(h.a)({},t.payload.id,Object(o.a)(Object(o.a)({},e.rooms[t.payload.id]),{},{lastMessage:t.payload.lastMessage})))});case"set current room":return Object(o.a)(Object(o.a)({},e),{},{currentRoom:t.payload});case"add room":return Object(o.a)(Object(o.a)({},e),{},{rooms:Object(o.a)(Object(o.a)({},e.rooms),{},Object(h.a)({},t.payload.id,t.payload))});case"set rooms":var n=t.payload,c=Object(o.a)({},e.rooms);return n.forEach((function(e){c[e.id]=Object(o.a)(Object(o.a)({},e),{},{messages:c[e.id]&&c[e.id].messages})})),Object(o.a)(Object(o.a)({},e),{},{rooms:c});default:return e}},x={currentRoom:"main",rooms:{},users:{}},g=Object(c.createContext)(),v=function(){var e=Object(c.useContext)(g),t=Object(i.a)(e,2);return[t[0],t[1]]},y=function(){return Object(c.useReducer)(p,x)},N=s(17),w=s.n(N),k=s(9),M=s.n(k);M.a.defaults.withCredentials=!0;var C=function(e){return"".concat("").concat(e)},L=function(){return M.a.get(C("/me")).then((function(e){return e.data})).catch((function(e){return null}))},E=function(e,t){return M.a.post(C("/login"),{username:e,password:t}).then((function(e){return e.data})).catch((function(e){throw new Error(e.response&&e.response.data&&e.response.data.message)}))},S=function(){return M.a.post(C("/logout"))},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;return M.a.get(C("/room/".concat(e,"/messages")),{params:{offset:t,size:s}}).then((function(e){return e.data.reverse()}))},z=function(e){return M.a.get(C("/users"),{params:{ids:e}}).then((function(e){return e.data}))},R=function(){var e=Object(u.a)(d.a.mark((function e(t,s){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M.a.post(C("/room"),{user1:t,user2:s}).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M.a.get(C("/rooms/".concat(t))).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=s(62),F=function(e,t){var s,n=Object(B.a)(e);try{for(n.s();!(s=n.n()).done;){var c=s.value;if("string"!==typeof c&&(c=c[0]),c!==t)return c}}catch(a){n.e(a)}finally{n.f()}return e[0]},T=(s(129),function(){var e=Object(u.a)(d.a.mark((function e(t,s,n){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c={},n.forEach((function(e){c[e.from]=1})),0===(a=Object.keys(c).filter((function(e){return void 0===t[e]}))).length){e.next=8;break}return e.next=6,z(a);case 6:r=e.sent,s({type:"append users",payload:r});case 8:case"end":return e.stop()}}),e)})));return function(t,s,n){return e.apply(this,arguments)}}()),U=function(){return Object(n.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 1651 1651",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(n.jsx)("rect",{width:"1651",height:"1651",rx:"14",fill:"white"}),Object(n.jsx)("path",{d:"M495.286 1098.96L497.967 1070.86L478.04 1050.88C408.572 981.233 368 891.771 368 795.344C368 585.371 565.306 402 826 402C1086.69 402 1284 585.371 1284 795.344C1284 1005.32 1086.69 1188.69 826 1188.69V1248.69L825.913 1188.69C779.837 1188.75 733.952 1182.77 689.432 1170.9L667.26 1164.98L646.8 1175.37C620.731 1188.61 562.74 1213.98 467.32 1235.35C480.554 1191.83 490.95 1144.39 495.286 1098.96Z",stroke:"url(#paint0_linear)",strokeWidth:"120"}),Object(n.jsx)("defs",{children:Object(n.jsxs)("linearGradient",{id:"paint0_linear",x1:"662.312",y1:"397.956",x2:"416.164",y2:"1678.7",gradientUnits:"userSpaceOnUse",children:[Object(n.jsx)("stop",{stopColor:"#7514FB"}),Object(n.jsx)("stop",{offset:"0.624243",stopColor:"#F26D41"}),Object(n.jsx)("stop",{offset:"1",stopColor:"#F43B4B"})]})})]})},H=function(e){var t=e.name,s=e.id,a=Object(c.useMemo)((function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1",t=13,s=654,n=531,c=+e.split(":").pop(),a=+e.split(":").reverse().pop();a<0&&(a+=3555);var r=(c*s+a*n)%t;return"".concat("","/avatars/").concat(r,".jpg")}(""+s);return"Mary"===t?"".concat("","/avatars/0.jpg"):"Pablo"===t?"".concat("","/avatars/2.jpg"):"Joe"===t?"".concat("","/avatars/9.jpg"):"Alex"===t?"".concat("","/avatars/8.jpg"):e}),[s,t]);return Object(n.jsx)(n.Fragment,{children:"General"!==t?Object(n.jsx)("img",{src:a,alt:t,style:{width:32,height:32,objectFit:"cover"},className:"rounded-circle avatar-xs"}):Object(n.jsx)("div",{className:"overflow-hidden rounded-circle",children:Object(n.jsx)(U,{})})})},W=function(e){var t=e.online,s=e.hide,c=void 0!==s&&s,a=e.width,r=void 0===a?8:a,o=e.height,i=void 0===o?8:o;return Object(n.jsx)("div",{className:t?"rounded-circle bg-success":"rounded-circle bg-gray",style:{width:r,height:i,opacity:c?0:1}})},P=function(e){var t=e.id,s=e.name,n=v(),a=Object(i.a)(n,1)[0],r=Object(c.useMemo)((function(){try{var e=Math.abs(parseInt(t.split(":").reverse().pop())),n=e>0,c=Object.entries(a.users).filter((function(e){return Object(i.a)(e,2)[1].username===s})).map((function(e){return Object(i.a)(e,2)[1]})),r=!1;return c.length>0&&(r=c[0].online,e=+c[0].id),[n,r,e]}catch(o){return[!1,!1,"0"]}}),[t,s,a.users]),o=Object(i.a)(r,3),l=o[0],d=o[1],u=o[2],j=D(e);return{isUser:l,online:d,userId:u,name:e.name,lastMessage:j}},D=function(e){var t=v(),s=Object(i.a)(t,2)[1],n=e.lastMessage;return Object(c.useEffect)((function(){void 0===n&&(void 0===e.messages?_(e.id,0,1).then((function(t){var n=null;0!==t.length&&(n=t.pop()),s({type:"set last message",payload:{id:e.id,lastMessage:n}})})):0===e.messages.length?s({type:"set last message",payload:{id:e.id,lastMessage:null}}):s({type:"set last message",payload:{id:e.id,lastMessage:e.messages[e.messages.length-1]}}))}),[n,s,e]),n},V=function(e){var t=e.room,s=e.active,c=void 0!==s&&s,a=e.onClick,r=P(t),o=r.online,i=r.name,l=r.lastMessage,d=r.userId;return Object(n.jsxs)("div",{onClick:a,className:"chat-list-item d-flex align-items-start rounded ".concat(c?"bg-white":""),children:[Object(n.jsx)("div",{className:"align-self-center mr-3",children:Object(n.jsx)(W,{online:o,hide:"0"===t.id})}),Object(n.jsx)("div",{className:"align-self-center mr-3",children:Object(n.jsx)(H,{name:i,id:d})}),Object(n.jsxs)("div",{className:"media-body overflow-hidden",children:[Object(n.jsx)("h5",{className:"text-truncate font-size-14 mb-1",children:i}),l&&Object(n.jsxs)("p",{className:"text-truncate mb-0",children:[" ",l.message," "]})]}),l&&Object(n.jsx)("div",{className:"font-size-11",children:w.a.unix(l.date).format("LT")})]})},G=s(132),J=function(e){var t=e.onLogOut,s=e.col,c=void 0===s?5:s,a=e.noinfo,r=void 0!==a&&a;return Object(n.jsxs)("div",{onClick:t,style:{cursor:"pointer"},className:"col-".concat(c," text-danger ").concat(r?"":"text-right"),children:[Object(n.jsx)(G.a,{})," Log out"]})},A=function(e){var t=e.user,s=e.col,c=void 0===s?7:s,a=e.noinfo,r=void 0!==a&&a;return Object(n.jsxs)("div",{className:"col-".concat(c," d-flex align-items-center ").concat(r?"justify-content-end":""),children:[Object(n.jsx)("div",{className:"align-self-center ".concat(r?"":"mr-3"),children:Object(n.jsx)(H,{name:t.username,id:t.id})}),!r&&Object(n.jsxs)("div",{className:"media-body",children:[Object(n.jsx)("h5",{className:"font-size-14 mt-0 mb-1",children:t.username}),Object(n.jsxs)("div",{className:"d-flex align-items-center",children:[Object(n.jsx)(W,{online:!0}),Object(n.jsx)("p",{className:"ml-2 text-muted mb-0",children:"Active"})]})]})]})},q=function(e){var t=e.user,s=e.onLogOut;return Object(n.jsx)("div",{className:"row no-gutters align-items-center pl-4 pr-2 pb-3",style:{height:"inherit",flex:0,minHeight:50},children:Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(A,{user:t,col:8}),Object(n.jsx)(J,{onLogOut:s,col:4})]})})},X=function(e){var t=e.rooms,s=e.dispatch,a=e.user,r=e.currentRoom,o=e.onLogOut,i=Object(c.useMemo)((function(){var e=Object.values(t);console.log(e);var s=e.filter((function(e){return"0"===e.id})),n=e.filter((function(e){return"0"!==e.id}));return n=n.sort((function(e,t){return+e.id.split(":").pop()-+t.id.split(":").pop()})),[].concat(Object(O.a)(s||[]),Object(O.a)(n))}),[t]);return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"chat-list-container flex-column d-flex pr-4",children:[Object(n.jsx)("div",{className:"py-2",children:Object(n.jsx)("p",{className:"h5 mb-0 py-1 chats-title",children:"Chats"})}),Object(n.jsx)("div",{className:"messages-box flex flex-1",children:Object(n.jsx)("div",{className:"list-group rounded-0",children:i.map((function(e){return Object(n.jsx)(V,{onClick:function(){return s({type:"set current room",payload:e.id})},active:r===e.id,room:e},e.id)}))})}),Object(n.jsx)(q,{user:a,onLogOut:o})]})})},Z=function(e){var t=e.message;return Object(n.jsx)("p",{className:"mb-2 fs-6 fw-light fst-italic text-black-50 text-center",style:{opacity:.8,fontSize:14},children:t})},K=function(){return Object(n.jsx)("div",{className:"no-messages flex-column d-flex flex-row justify-content-center align-items-center text-muted text-center",children:Object(n.jsx)("div",{className:"spinner-border",role:"status",children:Object(n.jsx)("span",{className:"visually-hidden"})})})},Q=s(133),Y=function(){return Object(n.jsxs)("div",{className:"no-messages flex-column d-flex flex-row justify-content-center align-items-center text-muted text-center",children:[Object(n.jsx)(Q.a,{size:96}),Object(n.jsx)("p",{children:"No messages"})]})},$=function(){return Object(n.jsxs)("svg",{width:12,height:12,className:"prefix__MuiSvgIcon-root prefix__jss80 prefix__MuiSvgIcon-fontSizeLarge",viewBox:"0 0 24 24","aria-hidden":"true",children:[Object(n.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),Object(n.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]})},ee=function(e){var t=e.username,s=void 0===t?"user":t,c=e.message,a=void 0===c?"Lorem ipsum dolor...":c,r=e.date;return Object(n.jsxs)("div",{className:"d-flex",children:[Object(n.jsx)("div",{style:{flex:1}}),Object(n.jsx)("div",{style:{width:"50%"},className:"text-right mb-4",children:Object(n.jsx)("div",{className:"conversation-list d-inline-block bg-light px-3 py-2",style:{borderRadius:12},children:Object(n.jsxs)("div",{className:"ctext-wrap",children:[Object(n.jsx)("div",{className:"conversation-name text-left text-primary mb-1",style:{fontWeight:600},children:s}),Object(n.jsx)("p",{className:"text-left",children:a}),Object(n.jsxs)("p",{className:"chat-time mb-0",children:[Object(n.jsx)($,{})," ",w.a.unix(r).format("LT")," "]})]})})})]})},te=function(e){var t=e.user,s=e.message,c=void 0===s?"Lorem ipsum dolor...":s,a=e.date,r=e.onUserClicked;return Object(n.jsxs)("div",{className:"d-flex",children:[Object(n.jsx)("div",{style:{width:"50%"},className:"text-left mb-4",children:Object(n.jsx)("div",{className:"conversation-list d-inline-block px-3 py-2",style:{borderRadius:12,backgroundColor:"rgba(85, 110, 230, 0.1)"},children:Object(n.jsxs)("div",{className:"ctext-wrap",children:[t&&Object(n.jsxs)("div",{className:"conversation-name text-primary d-flex align-items-center mb-1",children:[Object(n.jsx)("div",{className:"mr-2",style:{fontWeight:600,cursor:"pointer"},onClick:r,children:t.username}),Object(n.jsx)(W,{width:7,height:7,online:t.online})]}),Object(n.jsx)("p",{className:"text-left",children:c}),Object(n.jsxs)("p",{className:"chat-time mb-0",children:[Object(n.jsx)($,{})," ",w.a.unix(a).format("LT")," "]})]})})}),Object(n.jsx)("div",{style:{flex:1}})]})},se=function(e){var t=e.messageListElement,s=e.messages,c=e.room,a=e.onLoadMoreMessages,r=e.user,o=e.onUserClicked,i=e.users;return Object(n.jsxs)("div",{ref:t,className:"chat-box-wrapper position-relative d-flex",children:[void 0===s?Object(n.jsx)(K,{}):0===s.length?Object(n.jsx)(Y,{}):Object(n.jsx)(n.Fragment,{}),Object(n.jsx)("div",{className:"px-4 pt-5 chat-box position-absolute",children:s&&0!==s.length&&Object(n.jsxs)(n.Fragment,{children:[c.offset&&c.offset>=15?Object(n.jsxs)("div",{className:"d-flex flex-row align-items-center mb-4",children:[Object(n.jsx)("div",{style:{height:1,backgroundColor:"#eee",flex:1}}),Object(n.jsx)("div",{className:"mx-3",children:Object(n.jsx)("button",{"aria-haspopup":"true","aria-expanded":"true",type:"button",onClick:a,className:"btn rounded-button btn-secondary nav-btn",id:"__BVID__168__BV_toggle_",children:"Load more"})}),Object(n.jsx)("div",{style:{height:1,backgroundColor:"#eee",flex:1}})]}):Object(n.jsx)(n.Fragment,{}),s.map((function(e,t){var s=e.message+e.date+e.from+t;return"info"===e.from?Object(n.jsx)(Z,{message:e.message},s):+e.from!==+r.id?Object(n.jsx)(te,{onUserClicked:function(){return o(e.from)},message:e.message,date:e.date,user:i[e.from]},s):(console.log(i),Object(n.jsx)(ee,{username:i[e.from]?i[e.from].username:"",message:e.message,date:e.date},s))}))]})})]})},ne=function(e){var t=e.message,s=e.setMessage,c=e.onSubmit;return Object(n.jsx)("div",{className:"p-3 chat-input-section",children:Object(n.jsxs)("form",{className:"row",onSubmit:c,children:[Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("div",{className:"position-relative",children:Object(n.jsx)("input",{value:t,onChange:function(e){return s(e.target.value)},type:"text",placeholder:"Enter Message...",className:"form-control chat-input"})})}),Object(n.jsx)("div",{className:"col-auto",children:Object(n.jsxs)("button",{type:"submit",className:"btn btn-primary btn-rounded chat-send w-md",children:[Object(n.jsx)("span",{className:"d-none d-sm-inline-block mr-2",children:"Send"}),Object(n.jsx)("svg",{width:13,height:13,viewBox:"0 0 24 24",tabIndex:-1,children:Object(n.jsx)("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",fill:"white"})})]})})]})})},ce=function(e){var t=v(),s=Object(i.a)(t,2),n=s[0],a=s[1],r=Object(c.useRef)(null),l=n.rooms[n.currentRoom],j=null===l||void 0===l?void 0:l.id,m=null===l||void 0===l?void 0:l.messages,b=Object(c.useState)(""),f=Object(i.a)(b,2),O=f[0],h=f[1],p=Object(c.useCallback)((function(){setTimeout((function(){r.current&&(r.current.scrollTop=0)}),0)}),[]),x=Object(c.useCallback)((function(){r.current&&r.current.scrollTo({top:r.current.scrollHeight})}),[]);Object(c.useEffect)((function(){x()}),[m,x]);var g=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_(j,e).then(function(){var e=Object(u.a)(d.a.mark((function e(s){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(n.users,a,s);case 2:a({type:t?"prepend messages":"set messages",payload:{id:j,messages:s}}),t?setTimeout((function(){p()}),10):x();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a,j,x,p,n.users]);Object(c.useEffect)((function(){void 0!==j&&void 0===m&&g()}),[m,a,j,n.users,n,x,g]),Object(c.useEffect)((function(){r.current&&x()}),[x,j]);var y=function(){var t=Object(u.a)(d.a.mark((function t(s){var c,r,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.users[s],void 0!==(r=c.room)){t.next=10;break}return t.next=5,R(s,e.id);case 5:i=t.sent,r=i.id,console.log(r,s,e.id),a({type:"set user",payload:Object(o.a)(Object(o.a)({},c),{},{room:r})}),a({type:"add room",payload:{id:r,name:F(i.names,e.username)}});case 10:a({type:"set current room",payload:r});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{onLoadMoreMessages:Object(c.useCallback)((function(){g(l.offset,!0)}),[g,l]),onUserClicked:y,message:O,setMessage:h,dispatch:a,room:l,rooms:n.rooms,currentRoom:n.currentRoom,messageListElement:r,roomId:j,users:n.users,messages:m}};function ae(e){var t=e.onLogOut,s=e.user,c=e.onMessageSend,a=ce(s),r=a.onLoadMoreMessages,o=a.onUserClicked,i=a.message,l=a.setMessage,d=a.rooms,u=a.room,j=a.currentRoom,m=a.dispatch,b=a.messageListElement,f=a.roomId,O=a.messages,h=a.users;return Object(n.jsx)("div",{className:"container py-5 px-4",children:Object(n.jsxs)("div",{className:"chat-body row overflow-hidden shadow bg-light rounded",children:[Object(n.jsx)("div",{className:"col-4 px-0",children:Object(n.jsx)(X,{user:s,onLogOut:t,rooms:d,currentRoom:j,dispatch:m})}),Object(n.jsxs)("div",{className:"col-8 px-0 flex-column bg-white rounded-lg",children:[Object(n.jsx)("div",{className:"px-4 py-4",style:{borderBottom:"1px solid #eee"},children:Object(n.jsx)("h2",{className:"font-size-15 mb-0",children:u?u.name:"Room"})}),Object(n.jsx)(se,{messageListElement:b,messages:O,room:u,onLoadMoreMessages:r,user:s,onUserClicked:o,users:h}),Object(n.jsx)(ne,{message:i,setMessage:l,onSubmit:function(e){e.preventDefault(),c(i.trim(),f),l(""),b.current.scrollTop=b.current.scrollHeight}})]})]})})}function re(){return Object(n.jsx)("div",{className:"centered-box",children:Object(n.jsx)("div",{className:"spinner-border",role:"status",children:Object(n.jsx)("span",{className:"visually-hidden"})})})}var oe=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),s=(t[0],t[1]);return Object(c.useEffect)((function(){M.a.get(C("/links")).then((function(e){return e.data})).catch((function(e){return null})).then(s)}),[]),Object(n.jsx)(n.Fragment,{})},ie=s(63),le=s.n(ie),de=function(e,t,s){t({type:"set user",payload:e}),void 0!==s&&t({type:"append message",payload:{id:"0",message:{date:1e4*Math.random(),from:"info",message:s}}})},ue=function(){var e=y(),t=Object(i.a)(e,2),s=t[0],n=t[1],a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){},t=arguments.length>1?arguments[1]:void 0,s=Object(c.useState)(!0),n=Object(i.a)(s,2),a=n[0],r=n[1],o=Object(c.useState)(null),l=Object(i.a)(o,2),j=l[0],m=l[1],b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};s(null),n(!0),E(e,t).then((function(e){m(e)})).catch((function(e){return s(e.message)})).finally((function(){return n(!1)}))},f=function(){var e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S().then((function(){m(null),t({type:"clear"}),r(!0)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a&&L().then((function(t){m(t),r(!1),e(t)}))}),[e,a]),{user:j,onLogIn:b,onLogOut:f,loading:a}}(Object(c.useCallback)((function(e){null!==e&&(s.users[e.id]||n({type:"set user",payload:Object(o.a)(Object(o.a)({},e),{},{online:!0})}))}),[n,s.users]),n),r=a.user,l=a.onLogIn,j=a.onLogOut,m=a.loading,b=function(e,t){var s=Object(c.useState)(!1),n=Object(i.a)(s,2),a=n[0],r=n[1],o=Object(c.useRef)(null),l=o.current;return Object(c.useEffect)((function(){null===e?(null!==l&&l.disconnect(),r(!1)):(null!==l?l.connect():o.current=le()(),r(!0))}),[e,l]),Object(c.useEffect)((function(){a&&e?(l.on("user.connected",(function(e){de(e,t,"".concat(e.username," connected"))})),l.on("user.disconnected",(function(e){return de(e,t,"".concat(e.username," left"))})),l.on("show.room",(function(s){console.log({user:e}),t({type:"add room",payload:{id:s.id,name:F(s.names,e.username)}})})),l.on("message",(function(e){t({type:"make user online",payload:e.from}),t({type:"append message",payload:{id:void 0===e.roomId?"0":e.roomId,message:e}})}))):l&&(l.off("user.connected"),l.off("user.disconnected"),l.off("user.room"),l.off("message"))}),[a,e,t,l]),[l,a]}(r,n),f=Object(i.a)(b,2),O=f[0],h=f[1];Object(c.useEffect)((function(){if(null!==r)if(h){var e=[];Object.keys(s.rooms).forEach((function(t){var n=s.rooms[t];n.connected||(e.push(Object(o.a)(Object(o.a)({},n),{},{connected:!0})),O.emit("room.join",n.id))})),0!==e.length&&n({type:"set rooms",payload:e})}else{var t=[];Object.keys(s.rooms).forEach((function(e){var n=s.rooms[e];n.connected&&t.push(Object(o.a)(Object(o.a)({},n),{},{connected:!1}))})),0!==t.length&&n({type:"set rooms",payload:t})}}),[r,h,n,O,s.rooms,s.users]),Object(c.useEffect)((function(){0===Object.values(s.rooms).length&&null!==r&&(M.a.get(C("/users/online")).then((function(e){return e.data})).then((function(e){n({type:"append users",payload:e})})),I(r.id).then((function(e){var t=[];e.forEach((function(e){var s=e.id,n=e.names;t.push({id:s,name:F(n,r.username)})})),n({type:"set rooms",payload:t}),n({type:"set current room",payload:"0"})})))}),[n,s.rooms,r]);var p=Object(c.useCallback)((function(e,t){"string"===typeof e&&0!==e.trim().length&&(O||console.error("Couldn't send message"),O.emit("message",{roomId:t,message:e,from:r.id,date:w()(new Date).unix()}))}),[r,O]);return{loading:m,user:r,state:s,dispatch:n,onLogIn:l,onMessageSend:p,onLogOut:j}},je=function(){var e=ue(),t=e.loading,s=e.user,c=e.state,a=e.dispatch,r=e.onLogIn,o=e.onMessageSend,i=e.onLogOut;if(t)return Object(n.jsx)(re,{});var l=!s;return Object(n.jsx)(g.Provider,{value:[c,a],children:Object(n.jsxs)("div",{className:"full-height ".concat(l?"bg-light":""),style:{backgroundColor:l?void 0:"#495057"},children:[Object(n.jsx)(oe,{}),l?Object(n.jsx)(b,{onLogIn:r}):Object(n.jsx)(ae,{user:s,onMessageSend:o,onLogOut:i})]})})};r.a.render(Object(n.jsx)(je,{}),document.getElementById("root"))},68:function(e,t,s){},69:function(e,t,s){},70:function(e,t,s){},75:function(e,t,s){},78:function(e,t,s){}},[[128,1,2]]]);
//# sourceMappingURL=main.1239a531.chunk.js.map